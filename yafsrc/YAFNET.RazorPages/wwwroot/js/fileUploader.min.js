var FileUploader=function(){function n(e){var t,r=this;if(!(this instanceof n))throw"FileUploader must be instantiated with `new`.";for(t in this.config={dropZone:"js-file-uploader",url:void 0,fileInput:void 0,errorDelay:1e3,errorTitle:""},e)this.config[t]=e[t];const o="string"==typeof this.config.dropZone?document.getElementById(this.config.dropZone):this.config.dropZone;if(!o)throw"the drop zone element is undefined.";this.progressBar=document.getElementById("progress-bar"),this.dropArea=o,this.uploadProgress=[],["dragenter","dragover","dragleave","drop"].forEach(e=>{o.addEventListener(e,r.preventDefaults,!1),document.body.addEventListener(e,r.preventDefaults,!1)}),document.querySelector(this.config.fileInput).addEventListener("onchange",e=>{r.handleDrop(e,r)}),o.ondragenter=function(){r.highlight(r)},o.ondragover=function(){r.highlight(r)},o.ondragleave=function(){r.unhighlight(r)},o.ondrop=function(){r.unhighlight(r)},o.addEventListener("drop",e=>{r.handleDrop(e,r)},!1)}return n.prototype.unhighlight=function(e){e.dropArea.classList.remove("border-danger")},n.prototype.highlight=function(e){e.dropArea.classList.add("border-danger"),e.dropArea.classList.add("border-2")},n.prototype.preventDefaults=function(e){e.preventDefault(),e.stopPropagation()},n.prototype.bytesToSize=function(e,t=" "){var r,o=["Bytes","KB","MB","GB","TB"];return 0===e?"n/a":0===(r=parseInt(Math.floor(Math.log(e)/Math.log(1024)),10))?""+e+t+o[r]:""+(e/(1024*r)).toFixed(1)+t+o[r]},n.prototype.handleDrop=function(e,t){e=e.dataTransfer.files;t.handleFiles(t,e)},n.prototype.initializeProgress=function(t,r){t.progressBar.setAttribute("aria-valuenow",0),t.progressBar.querySelector(".progress-bar").style.width="0%",t.uploadProgress=[];for(let e=r;0<e;e--)t.uploadProgress.push(0)},n.prototype.updateProgress=function(e,t,r){e.uploadProgress[t]=r;t=e.uploadProgress.reduce((e,t)=>e+t,0)/e.uploadProgress.length;e.progressBar.setAttribute("aria-valuenow",t),e.progressBar.querySelector(".progress-bar").style.width=t+"%"},n.prototype.handleFiles=function(r,e){e=[...e],r.initializeProgress(r,e.length),e.forEach(e=>{r.previewFile(r,e)}),e.forEach(function(e,t){r.uploadFile(r,e,t)}),e=null,document.getElementById("gallery").replaceChildren(),bootstrap.Modal.getInstance("#UploadDialog").hide(),null!=document.querySelector("#fileupload .alert-danger")&&bootstrap.Alert.getInstance("#fileupload .alert-danger").close();getPaginationData(5,0,!1)},n.prototype.previewFile=function(e,t){var r=document.createElement("li");if(r.className="list-group-item list-group-item-action",r.innerHTML=`<div class="d-flex w-100 justify-content-between">
                                 <h5 class="mb-1">
                                     <span class="preview"></span>
                                 </h5>
                                 <small class="text-body-secondary size">${e.bytesToSize(t.size)}</small>
                             </div>
                             <div class="mb-1">
                                 <p class="name">${t.name}</p>
                             </div>
                             <small class="text-body-secondary">
                             <div class="btn-group" role="group">
                             </div></small>`,t.type.match("image.*")){const o=document.createElement("img"),n=new FileReader;o.classList.add("img-thumbnail"),n.readAsDataURL(t),n.onloadend=function(){o.src=n.result},r.querySelector(".preview").appendChild(o)}else{e=document.createElement("i");e.className="fa-regular fa-file",r.querySelector(".preview").appendChild(e)}document.getElementById("gallery").appendChild(r)},n.prototype.uploadFile=function(t,e,r){var o=t.config.url,n=new XMLHttpRequest,a=new FormData;n.open("POST",o,!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.upload.addEventListener("progress",function(e){t.updateProgress(t,r,100*e.loaded/e.total||100)}),n.addEventListener("readystatechange",function(){var e;4===n.readyState&&200===n.status?(t.updateProgress(t,r,100),(e=JSON.parse(n.response))[0].error?new Notify({title:t.config.errorTitle,message:e[0].error,icon:"fa fa-exclamation-triangle"},{type:"danger",element:"body",position:null,placement:{from:"top",align:"center"},delay:1e3*t.config.errorDelay}):insertAttachment(e[0].fileID,e[0].fileID)):4===n.readyState&&200!==n.status&&console.log(n)}),a.append("file",e),n.send(a)},n}();